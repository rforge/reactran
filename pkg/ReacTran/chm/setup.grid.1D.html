<html><head><title>Creation of a one-dimensional finite difference grid</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>setup.grid.1D(ReacTran)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   setup.grid.1D">
<param name="keyword" value="R:   plot.grid.1D">
<param name="keyword" value=" Creation of a one-dimensional finite difference grid">
</object>


<h2>Creation of a one-dimensional finite difference grid</h2>


<h3>Description</h3>

<p>
Subdivides the one-dimensional model domain into one or more zones that are each sub-divided into grid cells. The resulting grid structure can be used in the other ReacTran functions. The grid structure is characterized by the position of the middle of the grid cells (<code>x.mid</code>) and the position of the interfaces between cells (<code>x.int</code>). Distances are calculated between the interfaces (<code>dx</code>), i.e. the thickness of the grid cells. An auxiliary set of distances is calculated (<code>dx.aux</code>) between the points where the concentrations are specified (at the centers of the grid cell and the two external interfaces). A more complex grid consisting of multiple zones can be constructed when using vectors as arguments. In each zone, one can control the grid resolution near the upstream and downstream boundary. The grid resolution at the upstream interface changes according to the formula <code>dx[i+1] = min(max.dx.1,p.dx.1*dx[i])</code>.
A similar formula controls the resolution at the downstream interface. This allows refinement of the grid near the interfaces.
</p>


<h3>Usage</h3>

<pre>setup.grid.1D(x.up=0, x.down=NULL, L=NULL, N=NULL, dx.1=NULL,
 p.dx.1=rep(1,length(L)), max.dx.1=10*dx.1, dx.N=NULL,
 p.dx.N=rep(1,length(L)), max.dx.N=10*dx.N)

## S3 method for class 'grid.1D':
plot(x, ...)

                     </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x.up </code></td>
<td>
position of the upstream interface; one value </td></tr>
<tr valign="top"><td><code>x.down </code></td>
<td>
position of the endpoint of each zone; one value when the model domain covers only one zone (<code>x.down</code> = position of downstream interface), or a vector of length M when the model domain is divided into M zones (<code>x.down[M]</code> = position of downstream interface)</td></tr>
<tr valign="top"><td><code>L </code></td>
<td>
thickness of zones; one value (model domain = one zone) or a vector of length M (model domain = M zones)</td></tr>
<tr valign="top"><td><code>N </code></td>
<td>
number of grid cells within a zone; one value or a vector of length M</td></tr>
<tr valign="top"><td><code>dx.1 </code></td>
<td>
size of the first grid cell in a zone; one value or a vector of length M</td></tr>
<tr valign="top"><td><code>p.dx.1 </code></td>
<td>
factor controlling the increase in grid cell size near the upstream boundary; one value or a vector of length N. The default value is 1 (constant grid cell size)</td></tr>
<tr valign="top"><td><code>max.dx.1 </code></td>
<td>
maximum grid cell size in the upstream half of the zone; one value or a vector of length M</td></tr>
<tr valign="top"><td><code>dx.N </code></td>
<td>
size of the last grid cell in a zone; one value or a vector of length M</td></tr>
<tr valign="top"><td><code>p.dx.N </code></td>
<td>
factor controlling the increase in grid cell size near the downstream boundary; one value or a vector of length N. The default value is 1 (constant grid cell size)</td></tr>
<tr valign="top"><td><code>max.dx.N </code></td>
<td>
maximum grid cell size in the downstream half of the zone; one value or a vector of length M</td></tr>
<tr valign="top"><td><code>x </code></td>
<td>
the object of class <code>grid.1D</code> that needs plotting</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
additional arguments passed to the function <code>plot</code></td></tr>
</table>

<h3>Value</h3>

<p>
a list of type <code>grid.1D</code> containing:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>N </code></td>
<td>
the total number of grid cells</td></tr>
<tr valign="top"><td><code>x.up </code></td>
<td>
position of the upstream interface; one value</td></tr>
<tr valign="top"><td><code>x.down </code></td>
<td>
position of the downstream interface; one value </td></tr>
<tr valign="top"><td><code>x.mid </code></td>
<td>
position of the middle of the grid cells; vector of length <code>N</code></td></tr>
<tr valign="top"><td><code>x.int </code></td>
<td>
position of the interfaces of the grid cells; vector of length <code>N+1</code></td></tr>
<tr valign="top"><td><code>dx </code></td>
<td>
distance between adjacent cell interfaces (thickness of grid cells), vector of length <code>N</code></td></tr>
<tr valign="top"><td><code>dx.aux </code></td>
<td>
auxiliary vector containing the distance between adjacent cell centers; at the upper and lower boundary calculated as (<code>x[1]-x.up</code>) and (<code>x.down-x[N]</code>) respectively; vector of length <code>N+1</code></td></tr>
</table>

<h3>Author(s)</h3>

<p>
Filip Meysman &lt;f.meysman@nioo.knaw.nl&gt;, Karline Soetaert &lt;k.soetaert@nioo.knaw.nl&gt;
</p>


<h3>Examples</h3>

<pre>
# 1D Grid: one zone, constant resolution 
(GR &lt;- setup.grid.1D(x.up=0,L=10,N=10))
plot(GR)

# 1D Grid: one zone, constant resolution, origin not zero 
(GR&lt;-setup.grid.1D(x.up=5,x.down=10,N=10))
plot(GR)

# 1D Grid: one zone, higher resolution near the upstream interface 
(GR&lt;-setup.grid.1D(x.up=0,x.down=10,dx.1=0.1,p.dx.1=1.1))
plot(GR)

# 1D Grid: one zone, higher resolution near the upstream
# and downstream interface 
GR&lt;-setup.grid.1D(x.up=0,x.down=10,
dx.1=0.1,p.dx.1=1.1,dx.N=0.1,p.dx.N=1.1)
plot(GR)

# 1D Grid: two zones, higher resolution near the upstream
# and downstream interface 
(GR&lt;-setup.grid.1D(x.up=0,L=c(5,5),dx.1=c(0.2,0.2),p.dx.1=c(1.1,1.1),
                   dx.N=c(0.2,0.2),p.dx.N=c(1.1,1.1)))
plot(GR)

# 1D Grid: two zones, higher resolution near the upstream
# and downstream interface 
# the number of grid cells in each zone is imposed via N  
(GR &lt;- setup.grid.1D(x.up=0,L=c(5,5),N=c(20,10),dx.1=c(0.2,0.2),
             p.dx.1=c(1.1,1.1),dx.N=c(0.2,0.2),p.dx.N=c(1.1,1.1)))
plot(GR)
</pre>



<hr><div align="center">[Package <em>ReacTran</em> version 1.1 <a href="00Index.html">Index]</a></div>

</body></html>
