<html><head><title>General two-dimensional advective-diffusive transport</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>tran.2D(ReacTran)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   tran.2D">
<param name="keyword" value=" General two-dimensional advective-diffusive transport">
</object>


<h2>General two-dimensional advective-diffusive transport</h2>


<h3>Description</h3>

<p>
Estimates the transport term (i.e. the rate of change of the concentration due to diffusion and advection) in a two-dimensional rectangular model domain.
</p>


<h3>Usage</h3>

<pre>tran.2D(C, C.up=C[1,], C.down=C[nrow(C),],
C.left=C[,1], C.right=C[,ncol(C)], 
flux.up=NA, flux.down=NA, flux.left=NA, flux.right=NA,
a.bl.up=NULL, C.bl.up=NULL, a.bl.down=NULL, C.bl.down=NULL,
a.bl.left=NULL, C.bl.left=NULL, a.bl.right=NULL, C.bl.right=NULL,
D.x=NULL, D.y=D.x, D.grid=NULL, 
v.x=0, v.y=v.x, v.grid=NULL, 
AFDW.x=1, AFDW.y=AFDW.x, AFDW.grid=NULL, 
VF.x=1, VF.y=VF.x, VF.grid=NULL,
dx=NULL, dy=NULL, grid=NULL,
full.check = FALSE, full.output = FALSE)</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>C </code></td>
<td>
Concentration, expressed per unit volume, defined at the centre of each grid cell; NxM matrix [M/L3] </td></tr>
<tr valign="top"><td><code>C.up </code></td>
<td>
Concentration at upstream boundary; vector of length M [M/L3]</td></tr>
<tr valign="top"><td><code>C.down </code></td>
<td>
Concentration at downstream boundary; vector of length M [M/L3]</td></tr>
<tr valign="top"><td><code>C.left </code></td>
<td>
Concentration at left boundary; vector of length N [M/L3]</td></tr>
<tr valign="top"><td><code>C.right </code></td>
<td>
Concentration at right boundary; vector of length N [M/L3]</td></tr>
<tr valign="top"><td><code>flux.up </code></td>
<td>
Flux across the upstream boundary, positive = INTO model domain; vector of length M [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux.down </code></td>
<td>
Flux across the downstream boundary, positive = OUT of model domain; vector of length M [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux.left </code></td>
<td>
Flux across the left boundary, positive = INTO model domain; vector of length N [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux.right </code></td>
<td>
Flux across the right boundary, positive = OUT of model domain; vector of length N [M/L2/T]</td></tr>
<tr valign="top"><td><code>a.bl.up </code></td>
<td>
Transfer coefficient across the upstream boundary layer. <code>Flux=a.bl.up*(C.bl.up-C[1,])</code>. One value [L/T]</td></tr>
<tr valign="top"><td><code>C.bl.up </code></td>
<td>
Concentration at the upstream boundary layer; vector of length M  [M/L3]</td></tr>
<tr valign="top"><td><code>a.bl.down </code></td>
<td>
Transfer coefficient across the downstream boundary layer; <code>Flux=a.bl.down*(C[N,]-C.bl.down)</code>. One value [L/T]</td></tr>
<tr valign="top"><td><code>C.bl.down </code></td>
<td>
Concentration at the downstream boundary layer; vector of length M  [M/L3]</td></tr>
<tr valign="top"><td><code>a.bl.left </code></td>
<td>
Transfer coefficient across the left boundary layer. <code>Flux=a.bl.left*(C.bl.left-C[,1])</code>. One value [L/T]</td></tr>
<tr valign="top"><td><code>C.bl.left </code></td>
<td>
Concentration at the left boundary layer; vector of length N  [M/L3]</td></tr>
<tr valign="top"><td><code>a.bl.right </code></td>
<td>
Transfer coefficient across the right boundary layer; <code>Flux=a.bl.right*(C[,M]-C.bl.right)</code>. One value [L/T]</td></tr>
<tr valign="top"><td><code>C.bl.right </code></td>
<td>
Concentration at the right boundary layer; vector of length N  [M/L3]</td></tr>
<tr valign="top"><td><code>D.x </code></td>
<td>
diffusion coefficient in x-direction, defined on grid cell interfaces. One value or an (N+1)x(M) matrix [L2/T]</td></tr>
<tr valign="top"><td><code>D.y </code></td>
<td>
diffusion coefficient in y-direction, defined on grid cell interfaces. One value or an (N)x(M+1) matrix [L2/T]</td></tr>
<tr valign="top"><td><code>D.grid </code></td>
<td>
diffusion coefficient packaged as a grid list; the list contains at least the elements <code>x.int</code> and <code>y.int</code> (see <code><a href="setup.prop.2D.html">setup.prop.2D</a></code>)  [L2/T]</td></tr>
<tr valign="top"><td><code>v.x </code></td>
<td>
advective velocity in the x-direction, defined on grid cell interfaces. Can be positive (downstream flow) or negative (upstream flow). One value or an (N+1)x(M) matrix  [L/T]</td></tr>
<tr valign="top"><td><code>v.y </code></td>
<td>
advective velocity in the y-direction, defined on grid cell interfaces. Can be positive (downstream flow) or negative (upstream flow). One value or an (N)x(M+1) matrix  [L/T]</td></tr>
<tr valign="top"><td><code>v.grid </code></td>
<td>
advective velocity packaged as a grid list; the list contains at least the elements <code>x.int</code> and <code>y.int</code> (see <code><a href="setup.prop.2D.html">setup.prop.2D</a></code>) [L/T]</td></tr>
<tr valign="top"><td><code>AFDW.x </code></td>
<td>
weight used in the finite difference scheme for advection in the x-direction, defined on grid cell interfaces; backward = 1, centred = 0.5, forward = 0; default is backward. One value or an (N+1)x(M) matrix [-]</td></tr>
<tr valign="top"><td><code>AFDW.y </code></td>
<td>
weight used in the finite difference scheme for advection in the y-direction, defined on grid cell interfaces; backward = 1, centred = 0.5, forward = 0; default is backward. One value or an (N)x(M+1) matrix [-]</td></tr>
<tr valign="top"><td><code>AFDW.grid </code></td>
<td>
AFDW coefficients packaged as a grid list; the list contains at least the elements <code>x.int</code> and <code>y.int</code> (see <code><a href="setup.prop.2D.html">setup.prop.2D</a></code>) [-]</td></tr>
<tr valign="top"><td><code>VF.x </code></td>
<td>
Volume fraction at the grid cell interfaces in the x-direction. One value or an (N+1)x(M) matrix [-]</td></tr>
<tr valign="top"><td><code>VF.y </code></td>
<td>
Volume fraction at the grid cell interfaces in the y-direction. One value or an (N)x(M+1) matrix [-]</td></tr>
<tr valign="top"><td><code>VF.grid </code></td>
<td>
Volume fraction packaged as a grid list; the list contains at least the elements <code>x.int</code>, <code>y.int</code>, 'x.mid' and 'y.mid' (see <code><a href="setup.prop.2D.html">setup.prop.2D</a></code>) [-]</td></tr>
<tr valign="top"><td><code>dx </code></td>
<td>
distance between adjacent cell interfaces in the x-direction (thickness of grid cells). One value or vector of length N [L]</td></tr>
<tr valign="top"><td><code>dy </code></td>
<td>
distance between adjacent cell interfaces in the y-direction (thickness of grid cells). One value or vector of length M [L]</td></tr>
<tr valign="top"><td><code>grid </code></td>
<td>
discretization grid, a list containing at least elements <code>dx</code>, <code>dx.aux</code>, <code>dy</code>, <code>dy.aux</code> (see <code><a href="setup.grid.2D.html">setup.grid.2D</a></code>) [L]</td></tr>
<tr valign="top"><td><code>full.check </code></td>
<td>
logical flag enabling a full check of the consistency of the arguments (default = FALSE; TRUE slows down execution by 50 percent)</td></tr>
<tr valign="top"><td><code>full.output </code></td>
<td>
logical flag enabling a full return of the output (default = FALSE; TRUE slows down execution by 20 percent)</td></tr>
</table>

<h3>Details</h3>

<p>
The <B>boundary conditions</B> are either
<ul>
<li>(1) zero-gradient 
<li>(2) fixed concentration 
<li>(3) convective boundary layer 
<li>(4) fixed flux 
</ul>
<p>
This is also the order of priority. The zero gradient is the default, the fixed flux overrules all other.
</p>


<h3>Value</h3>

<p>
when (full.output = FALSE) then a list containing:
</p>
<table summary="R argblock">
<tr valign="top"><td><code>dC </code></td>
<td>
The rate of change of the concentration C due to transport, defined in the centre of each grid cell [M/L3/T]</td></tr>
<tr valign="top"><td><code>dC </code></td>
<td>
The rate of change of the concentration C due to transport, defined in the centre of each grid cell [M/L3/T]</td></tr>
<tr valign="top"><td><code>C.up </code></td>
<td>
Concentration at the upstream interface. One value [M/L3]</td></tr>
<tr valign="top"><td><code>C.down </code></td>
<td>
Concentration at the downstream interface. One value [M/L3]</td></tr>
<tr valign="top"><td><code>adv.flux </code></td>
<td>
Advective flux across at the interface of each grid cell. A vector of length N+1 [M/L2/T]</td></tr>
<tr valign="top"><td><code>dif.flux </code></td>
<td>
Diffusive flux across at the interface of each grid cell. A vector of length N+1 [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux </code></td>
<td>
Total flux across at the interface of each grid cell. A vector of length N+1 [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux.up </code></td>
<td>
Flux across the upstream boundary, positive = INTO model domain. One value [M/L2/T]</td></tr>
<tr valign="top"><td><code>flux.down </code></td>
<td>
Flux across the downstream boundary, positive = OUT of model domain. One value [M/L2/T]</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Filip Meysman &lt;f.meysman@nioo.knaw.nl&gt;, Karline Soetaert &lt;k.soetaert@nioo.knaw.nl&gt;
</p>


<h3>References</h3>

<p>
Soetaert and Herman, a guide to ecological modelling - using R as
a simulation platform, 2008. Springer
</p>


<h3>Examples</h3>

<pre>
# Parameters
F        &lt;- 100             # input flux [micromol cm-2 yr-1]
por      &lt;- 0.8             # constant porosity
D        &lt;- 400             # mixing coefficient [cm2 yr-1]
v        &lt;- 1               # advective velocity [cm yr-1]

# Grid definition
x.N &lt;- 4   # number of cells in x-direction
y.N &lt;- 6   # number of cells in y-direction
x.L &lt;- 8   # domain size x-direction [cm]
y.L &lt;- 24  # domain size y-direction [cm]
dx       &lt;- x.L/x.N             # cell size x-direction [cm]
dy       &lt;- y.L/y.N             # cell size y-direction [cm]
 
# Intial conditions 
C &lt;- matrix(nrow=x.N,ncol=y.N,data=0,byrow=FALSE)

# Boundary conditions: fixed concentration  
C.up=rep(1,times=y.N)
C.down=rep(0,times=y.N)
C.left=rep(1,times=x.N)
C.right=rep(0,times=x.N)

# Only diffusion 
tran.2D(full.output=TRUE,C=C,D.x=D,D.y=D,v.x=0,
v.y=0,VF.x=por,VF.y=por,dx=dx,dy=dy,C.up=C.up,C.down=C.down,
C.left=C.left,C.right=C.right)  

# Strong advection, backward (default), central and forward 
#finite difference schemes 
tran.2D(C=C,D.x=D,v.x=100*v,VF.x=por,dx=dx,dy=dy,
C.up=C.up,C.down=C.down,C.left=C.left,C.right=C.right)  
tran.2D(AFDW.x=0.5,C=C,D.x=D,v.x=100*v,VF.x=por,dx=dx,dy=dy,
C.up=C.up,C.down=C.down,C.left=C.left,C.right=C.right)  
tran.2D(AFDW.x=0,C=C,D.x=D,v.x=100*v,VF.x=por,dx=dx,dy=dy,
C.up=C.up,C.down=C.down,C.left=C.left,C.right=C.right)  

# Boundary conditions: fixed fluxes 

flux.up=rep(200,times=y.N)
flux.down=rep(-200,times=y.N)
flux.left=rep(200,times=x.N)
flux.right=rep(-200,times=x.N)
tran.2D(C=C,D.x=D,v.x=0,VF.x=por,dx=dx,dy=dy,
flux.up=flux.up,flux.down=flux.down,
flux.left=flux.left,flux.right=flux.right)  

# Boundary conditions: convective boundary layer on all sides

a.bl &lt;- 800   # transfer coefficient
C.bl.up &lt;- rep(1,times=(y.N)) # fixed conc at boundary layer
C.bl.left &lt;- rep(1,times=(x.N)) # fixed conc at boundary layer
tran.2D(full.output=TRUE,C=C,D.x=D,v.x=0,VF.x=por,
dx=dx,dy=dy,C.bl.up=C.bl.up,a.bl.up=a.bl,C.bl.down=C.bl.up,
a.bl.down=a.bl,C.bl.left=C.bl.left,a.bl.left=a.bl,
C.bl.right=C.bl.left,a.bl.right=a.bl)  

# Runtime test with and without argument checking

n.iterate &lt;-1000

test1 &lt;- function()
{
for (i in 1:n.iterate )
ST&lt;-tran.2D(full.check=TRUE,C=C,D.x=D,v.x=0,VF.x=por,
dx=dx,dy=dy,C.bl.up=C.bl.up,a.bl.up=a.bl,C.down=C.down)  
} 
system.time(test1())

test2 &lt;- function()
{
for (i in 1:n.iterate )
ST&lt;-tran.2D(full.output=TRUE,C=C,D.x=D,v.x=0,VF.x=por,
dx=dx,dy=dy,C.bl.up=C.bl.up,a.bl.up=a.bl,C.down=C.down)  
} 
system.time(test2())

test3 &lt;- function()
{
for (i in 1:n.iterate )
ST&lt;-tran.2D(full.output=TRUE,full.check=TRUE,C=C,D.x=D,v.x=0,
VF.x=por,dx=dx,dy=dy,C.bl.up=C.bl.up,a.bl.up=a.bl,C.down=C.down)  
} 
system.time(test3())

</pre>



<hr><div align="center">[Package <em>ReacTran</em> version 1.1 <a href="00Index.html">Index]</a></div>

</body></html>
